# malware.py
import os

def simulate_malware_attack(original_path, infected_path):
    """
    Reads the original file, appends a 'malicious' payload, 
    and saves it to the infected directory.
    """
    print(f"[*] Simulating malware attack on: {original_path}")
    
    try:
        # 1. Read the clean content
        with open(original_path, "r") as f:
            content = f.read()
        
        # 2. Inject the 'malicious' payload
        malicious_payload = "\n\n<SCRIPT> Malicious Code Injected Here </SCRIPT>"
        infected_content = content + malicious_payload
        
        # 3. Ensure the infected directory exists
        os.makedirs(os.path.dirname(infected_path), exist_ok=True)
        
        # 4. Write the infected file
        with open(infected_path, "w") as f:
            f.write(infected_content)
            
        print(f"[!] File corrupted and saved to: {infected_path}")
        return True
    except Exception as e:
        print(f"[X] Attack failed: {e}")
        return False
